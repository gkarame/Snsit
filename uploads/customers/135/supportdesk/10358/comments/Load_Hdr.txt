SELECT CASE WHEN MIN(ISSHIPPED) <> 'Y' THEN '' ELSE MAX(SHIPDATE) END SHIPDATE 
FROM LOADHDR LH,LOADSTOP LS, LOADORDERDETAIL LOD
WHERE LH.LOADID = '"+(String)globalMap.get("loadid")+"' AND LH.LOADID = LS.LOADID AND LS.LOADSTOPID = LOD.LOADSTOPID
"SELECT  LTRIM(RTRIM(O.TRX_NUMBER))  AS TRX_NUMBER        ,
LTRIM(RTRIM(O.CONS_BILLING_INT)) AS CONS_BILLING_INT ,
 O.TRX_DATE            ,
  LTRIM(RTRIM(O.ORGANIZATION_ID)) AS ORGANIZATION_ID      ,
  O.ADDRESS_ID           ,
  (case TRX_TYPE
when 'NORMAL' then '1'
when 'INTERNAL' then '50'
when 'ADV' then '54'
when 'IMMEDIATE' then '56'
when 'CASHVAN' then '58'
when 'CONSIGNMENT' then '58'
when 'WAREHOUSE' then '58'
when 'IRRISS' then '60'
when 'RECDAM' then '62'
when 'SUPRET' then '64'
when 'IRRDAM' then '66'
when 'RECISS' then '68'
when 'InterOrg' then '72'
when 'NEAREXPIRY' then '80'
when 'VRAC' then '92'
when 'DAMAGED' then '100'
end ) TRX_TYPE            ,  
  O.SHIPVIA              ,  
  O.LINE_ID              ,
  O.ITEM_CODE            ,
  O.QUANTITY             ,
  O.UOM                  ,
    LTRIM(RTRIM(O.SRC_SUBINVENTORY)) AS SRC_SUBINVENTORY     ,
  O.BATCH_ID             ,
O.DELIVERY_DATE , 
  (CASE O.SHIPMENT_TYPE WHEN 'THIRD PARTY'  THEN '1' ELSE '5' END  ) AS  SHIPMENT_TYPE  ,
  O.ITEM_TYPE    ,
(CASE O.ITEM_TYPE WHEN 'NON-VRAC' THEN 'STD' ELSE 'VRAC' END )AS PREALLOCSTG ,
RIGHT('00000' + CONVERT(varchar, ROW_NUMBER() over (order by O.LINE_ID)), 5) AS ORDERLINE,
PROFLAG,
S.DEFAULTROTATION AS ROTATION ,
S.ROTATEBY AS SKUROTATION  ,
CASE ST.COMPANY WHEN 'null' THEN NULL ELSE ST.COMPANY END ,
CASE ST.ADDRESS1 WHEN 'null' THEN NULL ELSE ST.ADDRESS1 END ,
CASE ST.ADDRESS2 WHEN 'null' THEN NULL ELSE ST.ADDRESS2 END ,
CASE ST.CITY WHEN 'null' THEN NULL ELSE ST.CITY END ,
CASE ST.STATE WHEN 'null' THEN NULL ELSE ST.STATE END ,
S.PACKKEY ,
S.SHELFLIFE,
S.STDCUBE AS CUBE,
S.STDGROSSWGT AS WEIGHT ,
CASE O.freeflag WHEN 'Y' THEN '100' ELSE '0' END ,
REQUEST_ID
   FROM ORDERSTAGING O ,SKU S ,STORER ST 
   WHERE O.ITEM_CODE= S.SKU
   AND ST.STORERKEY=O.ADDRESS_ID  
AND ST.TYPE='2'
  AND S.STORERKEY=O.ORGANIZATION_ID
AND  TRX_NUMBER='"+(String)globalMap.get("myKey")+"' 

order by 1,8"